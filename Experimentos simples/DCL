install.packages("mice")
install.packages("corrplot")
install.packages("GGally")
library(GGally)
library(mice) #para realizar imputación múltiple
library(corrplot)
library(readxl)
library(doebioresearch)
library(performance)
library(dplyr)
library(ScottKnott)
library(agricolae)
library(car)
library(broom)
library(data.table)        
library(emmeans)
library(ggplot2)
library(tidyverse)
library(lattice)
library(nlme)
library(lme4)
library(lmerTest)
library(multcomp)
library(rstatix)
library(ggpubr)
library(see)

datos<- read_excel("LABORATORIO DE FERTI CÁLCULOS.xlsx")
setwd("C:/Users/LUIS/Desktop/USAC 2/9no. semestre/MIAPA/Base de datos")
attach(datos)
str(datos)
head(datos)
tail(datos)
view(datos)
TRC<- factor(Puntos)
FILA<-factor(Dia)
COL<-factor(Hora)
Resp<-as.vector(ppm)
Resp1<-as.numeric(Resp)
boxplot(split(Resp1,TRQ),xlab="Puntos de Ciudad", ylab="Concentraciones de monóxido de carbono")

#ANDEVA
DCL.aov<-aov(Resp1 ~ FILA + COL + TRC)
anova(DCL.aov)
cv.model(DCL.aov)

DCL.lm <- lm(Resp1 ~ FILA + COL + TRC)
anova(DCL.lm)

#Supuestos
shapiro.test(DCL.lm$res)

qqPlot(DCL.aov)
fitc <- fitted(DCL.aov)
res_stc <- rstandard(DCL.aov)  
plot(fitc,res_stc,xlab="Valores predichos", ylab="Residuos estandarizados",abline(h=0))

bartlett.test(Resp1 ~ TRC)
leveneTest(Resp1 ~ TRC, center = "median")

#PMM
outLSD <-LSD.test(DCL.aov, "TRC",console=TRUE)
outHSD<-HSD.test(DCL.aov, "TRC",console=TRUE) #Tukey
SNK.test(DCL.aov, "TRC",console=TRUE)
scheffe.test(DCL.aov, "TRC",console=TRUE)
duncan.test(DCL.aov, "TRC",console=TRUE)
LSD.test(DCL.aov, "TRC", p.adj= "bon",console=TRUE)
sk <- SK(DCL.aov, which= "TRC",  dispersion="se", sig.level=0.05)
summary(sk)
